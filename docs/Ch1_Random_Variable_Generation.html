<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Computational Statistics (M.Sc.) - 1&nbsp; Random Variable Generation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./Ch2_MonteCarlo.html" rel="next">
<link href="./index.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Random Variable Generation</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./" class="sidebar-logo-link">
      <img src="./images/Uni_Bonn_Logo.jpeg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Computational Statistics (M.Sc.)</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Organization of the Course</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch1_Random_Variable_Generation.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Random Variable Generation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch2_MonteCarlo.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Monte Carlo Integration</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch3_Bootstrap.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">The Bootstrap</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch4_MaximumLikelihood.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Maximum Likelihood</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Ch5_EMAlgorithmus.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">The Expectation Maximization (EM) Algorithm</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#literature" id="toc-literature" class="nav-link active" data-scroll-target="#literature">Literature</a></li>
  <li><a href="#introduction-motivation" id="toc-introduction-motivation" class="nav-link" data-scroll-target="#introduction-motivation">Introduction &amp; Motivation</a></li>
  <li><a href="#uniform-simulation" id="toc-uniform-simulation" class="nav-link" data-scroll-target="#uniform-simulation"><span class="toc-section-number">1.1</span>  Uniform Simulation</a></li>
  <li><a href="#generation-of-discrete-random-variables" id="toc-generation-of-discrete-random-variables" class="nav-link" data-scroll-target="#generation-of-discrete-random-variables"><span class="toc-section-number">1.2</span>  Generation of Discrete Random Variables</a></li>
  <li><a href="#generation-of-continuous-random-variables" id="toc-generation-of-continuous-random-variables" class="nav-link" data-scroll-target="#generation-of-continuous-random-variables"><span class="toc-section-number">1.3</span>  Generation of Continuous Random Variables</a>
  <ul class="collapse">
  <li><a href="#the-inverse-method" id="toc-the-inverse-method" class="nav-link" data-scroll-target="#the-inverse-method"><span class="toc-section-number">1.3.1</span>  The Inverse Method</a></li>
  <li><a href="#transformation-methods" id="toc-transformation-methods" class="nav-link" data-scroll-target="#transformation-methods"><span class="toc-section-number">1.3.2</span>  Transformation Methods</a></li>
  <li><a href="#accept-reject-methods" id="toc-accept-reject-methods" class="nav-link" data-scroll-target="#accept-reject-methods"><span class="toc-section-number">1.3.3</span>  Accept-Reject Methods</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Random Variable Generation</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="literature" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="literature">Literature</h3>
<p>In principle, it is sufficient to read this script, but I can recommend the following books for further self-studies:</p>
<ul>
<li><a href="http://www.springer.com/us/book/9780387212395">Monte Carlo Statistical Methods</a>, Ch. 2, <span class="citation" data-cites="RobertCasella1999">Robert and Casella (<a href="#ref-RobertCasella1999" role="doc-biblioref">2004</a>)</span></li>
<li><a href="https://link.springer.com/book/10.1007/978-1-4419-1576-4">Introducing Monte Carlo Methods with R</a>, Ch. 2, <span class="citation" data-cites="RobertCasella2010">Robert and Casella (<a href="#ref-RobertCasella2010" role="doc-biblioref">2010</a>)</span></li>
</ul>
<!-- * Further:
  * [Non-Uniform Random Variate Generation](http://luc.devroye.org/rnbookindex.html), Devroye, L. 
  * [Nonparametric Density Estimation: The L1 View](http://luc.devroye.org/L1bookBW.pdf), Devroye, L., Ch. 8
  * [Monte Carlo and Quasi-Monte Carlo Sampling](http://www.springer.com/us/book/9780387781648), Lemieux, C., Ch. 2 and 3 -->
</section>
<section id="introduction-motivation" class="level3 unnumbered">
<h3 class="unnumbered anchored" data-anchor-id="introduction-motivation">Introduction &amp; Motivation</h3>
<p>In many complex statistical models parameter estimates can only be calculated numerically and their (statistical) behavior can only be investigated through a <strong>simulation</strong> on the computer:</p>
<p><strong>Stylized Algorithm:</strong></p>
<ul>
<li><strong>Step 1</strong> Generate artificial data from a statistical model and compute the estimate(s) of interest.</li>
<li><strong>Step 2</strong> Repeat this 10000 (or more) times.</li>
<li><strong>Step 3</strong> From these 10000 “pseudo” realizations of the estimator we can directly compute, e.g., the bias or the mean squared error (MSE) of the estimator—without the need of complicated statistical theory.</li>
</ul>
<div class="cell" data-hash="Ch1_Random_Variable_Generation_cache/html/unnamed-chunk-1_310d82b5672bf1add47868f68402abb7">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 1</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>generate_mean_estimates <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">n =</span> <span class="dv">100</span>){</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="do">## generate artificial data</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  artificial_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)   </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">## compute the estimate</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  estimate        <span class="ot">&lt;-</span> <span class="fu">mean</span>(artificial_data) </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(estimate)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 2 </span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">223</span>)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>simulated_estimates <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="dv">1000</span>, </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>                                 <span class="fu">generate_mean_estimates</span>(<span class="at">n =</span> <span class="dv">100</span>))</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Step 3</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(simulated_estimates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.003045196</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(simulated_estimates)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.09714423</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(simulated_estimates, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">"Histogram of Simulated Mean Estimates"</span>, </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Ch1_Random_Variable_Generation_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In order to conduct Steps 1 and 2 we need artificial realizations (here we used <code>rnorm()</code>) of a random variable—so-called <strong>Pseudo Random Numbers</strong>. The generation of such pseudo random numbers is the topic of the following chapters.</p>
</section>
<section id="uniform-simulation" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="uniform-simulation"><span class="header-section-number">1.1</span> Uniform Simulation</h2>
<p><strong>General procedure:</strong></p>
<ul>
<li>Usually, a random integer with values <strong>uniformly</strong> in <span class="math inline">\([0,m]\)</span> with a large integer <span class="math inline">\(m\)</span> is generated.</li>
<li>To achieve a random number in <span class="math inline">\([0, 1]\)</span>, we divide this number by <span class="math inline">\(m\)</span>.</li>
<li>From this (pseudo) uniform random numbers we can generate random numbers of almost any other distribution.</li>
</ul>
<p>There are many different <strong>Random Number Generators (RNGs)</strong>, we consider the most simple class of RNGs:</p>
<div id="def-LinConGen" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 1.1 (Linear Congruential Generators) </strong></span>Here the <span class="math inline">\(i\)</span>th random integer <span class="math inline">\(u_i\)</span> is generated by <span class="math display">\[
u_i=(a u_{i-1}+c) \,\operatorname{mod}\, m,
\]</span> where the starting value <span class="math inline">\(u_0\)</span> is a chosen and fixed value called <strong>seed</strong>.</p>
<p>Furthermore:</p>
<ul>
<li><span class="math inline">\(m\)</span>, with <span class="math inline">\(0&lt;m\)</span>, is called the <strong>modulus</strong></li>
<li><span class="math inline">\(a\)</span>, with <span class="math inline">\(0&lt;a&lt;m\)</span>, is called the <strong>multiplier</strong></li>
<li><span class="math inline">\(c\)</span>, with <span class="math inline">\(0\leq c&lt;m\)</span>, is called the <strong>increment</strong></li>
</ul>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
The modulo operator: <span class="math inline">\(\operatorname{mod}\)</span>
</div>
</div>
<div class="callout-body-container callout-body">
<p>“<span class="math inline">\(b\,\operatorname{mod}\,c\)</span>” denotes the remainder of the division of <span class="math inline">\(b\)</span> by <span class="math inline">\(c\)</span>.</p>
<p>For instance <span class="math display">\[
\begin{align*}
4\,&amp;\operatorname{mod}\,2 = 0\\
5\,&amp;\operatorname{mod}\,2 = 1\\
1\,&amp;\operatorname{mod}\,2 = 1\\
\end{align*}
\]</span></p>
<div class="cell" data-hash="Ch1_Random_Variable_Generation_cache/html/unnamed-chunk-2_27f357dacdc1175486533fbdd86713ca">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modulo computation using the modulo operator '%%'</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span> <span class="sc">%%</span> <span class="dv">4</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="dv">9</span> <span class="sc">%%</span> <span class="dv">4</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span> <span class="sc">%%</span> <span class="dv">5</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># own modulo-function:</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>my_mod <span class="ot">&lt;-</span> <span class="cf">function</span>(x,m){</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  t1 <span class="ot">&lt;-</span> <span class="fu">floor</span>(x<span class="sc">/</span>m)</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x<span class="sc">-</span>t1<span class="sc">*</span>m)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
<p>Some Facts:</p>
<ul>
<li>The above recursion generates a completely <strong>nonrandom</strong> sequence, therefore it is often called a <strong><em>pseudo</em> random</strong> sequence.</li>
<li>Under appropriate choices of <span class="math inline">\(u_0\)</span> , <span class="math inline">\(a\)</span> and <span class="math inline">\(m\)</span> the generated (deterministic) sequence behaves like a sequence of independent random draws from a uniform distribution on <span class="math inline">\([0, m]\)</span>.</li>
<li>The cycle length of linear congruential generators will never exceed modulus <span class="math inline">\(m\)</span>, but can maximized with the three following conditions (see <a href="https://en.wikipedia.org/wiki/The_Art_of_Computer_Programming">Knuth (2002)</a> for a proof):
<ul>
<li>The increment <span class="math inline">\(c\)</span> is <a href="https://en.wikipedia.org/wiki/Coprime_integers">relatively prime</a> to <span class="math inline">\(m\)</span>,</li>
<li><span class="math inline">\(a - 1\)</span> is a multiple of every prime dividing <span class="math inline">\(m\)</span>,</li>
<li><span class="math inline">\(a - 1\)</span> is a multiple of <span class="math inline">\(4\)</span> when <span class="math inline">\(m\)</span> is a multiple of <span class="math inline">\(4\)</span>.</li>
</ul></li>
</ul>
<!--
Further reading:
Ripley (1987) provides a review of number generators. 
Devroye (1986) is very comprehensive book on non-uniform random variate generation.
-->
<p><strong>Bad choice of parameters</strong> for the linear congruential random number generator:</p>
<div class="cell" data-hash="Ch1_Random_Variable_Generation_cache/html/unnamed-chunk-3_c333ef6e5f657b66685a677a124cd3fc">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">64</span>    <span class="co"># modulus</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">33</span>    <span class="co"># multiplier</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>c <span class="ot">&lt;-</span> <span class="dv">12</span>    <span class="co"># increment</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">57</span>    <span class="co"># seed</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># length of run (including seed)</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>r_vec    <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n) <span class="co"># initialize vector</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>r_vec[<span class="dv">1</span>] <span class="ot">&lt;-</span> s <span class="co"># set seed</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Recursive generation </span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n<span class="dv">-1</span>)){</span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a> r_vec[i<span class="sc">+</span><span class="dv">1</span>] <span class="ot">&lt;-</span> (a <span class="sc">*</span> r_vec[i] <span class="sc">+</span> c) <span class="sc">%%</span> m</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a><span class="co"># scale result from [0,m] to [0,1]:</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>my_bad_runif_vec <span class="ot">&lt;-</span> r_vec<span class="sc">/</span>m</span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="co"># BUT! Very short cycle-length (here: period=16)</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>r_vec[ <span class="dv">1</span><span class="sc">:</span><span class="dv">16</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 57 37 17 61 41 21  1 45 25  5 49 29  9 53 33 13</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>r_vec[<span class="dv">17</span><span class="sc">:</span><span class="dv">32</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 57 37 17 61 41 21  1 45 25  5 49 29  9 53 33 13</code></pre>
</div>
</div>
<div id="exm-GoodVsBadRNG" class="theorem example">
<p><span class="theorem-title"><strong>Example 1.1 (Good vs.&nbsp;Bad RNGs) </strong></span>Average heads ratios <span class="math display">\[
\bar{C}_n=\frac{1}{n}\sum_{i=1}^nC_i
\]</span> for <span class="math inline">\(n=1,2,\dots\)</span> simulated independent tosses of a fair coin <span class="math inline">\(C_i\)</span> with<br>
<span class="math display">\[
C_{i}=\left\{\begin{array}{ll}
1&amp;\text{if Head}\\
0&amp;\text{if Tail}
\end{array}\right.
\]</span> and <span class="math display">\[
P(C_i=0)=P(C_i=1)=0.5.
\]</span> By the strong (or weak) law of large numbers the average should converge <strong>stochastically</strong> (i.e., almost surely or in probability) to <span class="math inline">\(0.5\)</span> as <span class="math inline">\(n\)</span> becomes large <span class="math inline">\((n\to\infty),\)</span> <span class="math display">\[
\bar{C}_n=\frac{1}{n}\sum_{i=1}^nC_i \to_p 0.5,\quad n \to\infty.
\]</span></p>
<div class="cell" data-layout-align="center" data-hash="Ch1_Random_Variable_Generation_cache/html/fig-goodvsbad_958bdcb1072aef018e98ca723334ed2c">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># using the above bad RNG:</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>bar_x_bad  <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(my_bad_runif_vec <span class="sc">&gt;</span> <span class="fl">0.5</span>)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># using R's high-quality RNG:</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">223</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>bar_x_good <span class="ot">&lt;-</span> <span class="fu">cumsum</span>(<span class="fu">runif</span>(n)  <span class="sc">&gt;</span> <span class="fl">0.5</span> )<span class="sc">/</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plotting the results:</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(bar_x_bad, <span class="at">type=</span><span class="st">"l"</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">0.46</span>,<span class="fl">0.54</span>), </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">""</span>, <span class="at">ylab=</span><span class="st">""</span>, <span class="at">main=</span><span class="st">"Good vs. Bad RNG"</span>)</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(bar_x_good, <span class="at">col=</span><span class="st">"darkblue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div id="fig-goodvsbad" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Ch1_Random_Variable_Generation_files/figure-html/fig-goodvsbad-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1.1: Two sample paths showing the pseudo random convergence of <span class="math inline">\(\bar{C}_n\)</span> to the limit 0.5—one based on a good RNG and the other based on a bad RNG.</figcaption><p></p>
</figure>
</div>
</div>
</div>
</div>
<!--

::: {.cell hash='Ch1_Random_Variable_Generation_cache/html/unnamed-chunk-5_ec9f0e905fbcb657722022c2e0743a89'}

```{.r .cell-code}
## See also:
install.packages("randtoolbox")
library("randtoolbox")
?congruRand()
```
:::

-->
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>IBM’s <a href="https://en.wikipedia.org/wiki/RANDU">RANDU</a> is a famous example of an miss-specified linear congruential RNG.</p>
</div>
</div>
</section>
<section id="generation-of-discrete-random-variables" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="generation-of-discrete-random-variables"><span class="header-section-number">1.2</span> Generation of Discrete Random Variables</h2>
<!-- https://rpubs.com/maheshraje982/617094 -->
<p>Assume the discrete random variable <span class="math inline">\(X\)</span> of interest takes on the values <span id="eq-DiscRV"><span class="math display">\[
X\in \{x_1, \dots , x_k \}
\tag{1.1}\]</span></span> with <span class="math display">\[
p_i = \mathbb{P}(X = x_i ), \quad i = 1,\dots , k,
\]</span> and <span class="math display">\[
\sum_{i=1}^kp_i = 1.
\]</span></p>
<p>Assume that you can generate pseudo-random realizations <span class="math inline">\(u\in[0,1]\)</span> from a uniformly distributed random variable <span class="math inline">\(U\sim\mathcal{U}[0, 1]\)</span> using an RNG.</p>
<p><strong>General principle:</strong></p>
<ol type="1">
<li>Subdivide <span class="math inline">\([0, 1]\)</span> into <span class="math inline">\(k\)</span> intervals with <span class="math display">\[
I_i = (a_{i-1}, a_i],
\]</span> where <span class="math display">\[
a_i = \sum_{j=1}^ip_j\quad\text{and}\quad a_0 = 0.
\]</span></li>
<li>Define the new discrete realizations <span id="eq-U2DiscrX"><span class="math display">\[x=\left\{
\begin{array}{cc}
       x_1&amp;\quad\text{if}\quad u\in I_1\\
       \vdots&amp; \vdots\\
       x_k&amp;\quad\text{if}\quad u\in I_k
       \end{array}\right.
\tag{1.2}\]</span></span></li>
</ol>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">

</div>
</div>
<div class="callout-body-container callout-body">
<div id="lem-GenDiscrRV" class="theorem lemma">
<p><span class="theorem-title"><strong>Lemma 1.1 </strong></span>Let <span class="math inline">\(u\)</span> be a realization from <span class="math inline">\(\mathcal{U}[0, 1]\)</span> and if <span class="math inline">\(u\in I_i\)</span>, set <span class="math inline">\(x = x_i\)</span> (see <a href="#eq-U2DiscrX">Equation&nbsp;<span>1.2</span></a>). Then <span class="math inline">\(x\)</span> is a realizaton of the discrete random variable <span class="math inline">\(X\)</span> (see <a href="#eq-DiscRV">Equation&nbsp;<span>1.1</span></a>).</p>
</div>
</div>
</div>
<!-- **Proof:** Done in the lecture. -->
<p><strong>Proof:</strong></p>
<p>For any <span class="math inline">\(i = 1, \dots, k\)</span> we have that <span class="math display">\[
\begin{align*}
\mathbb{P}(X = x_i)
&amp; = \mathbb{P}(U \in I_i)  \\
&amp; = F_\mathcal{U}(a_i) - F_\mathcal{U}(a_{i-1})\\
&amp; = a_i - a_{i-1}\\
&amp; = \sum_{j=1}^ip_j - \sum_{j=1}^{i-1}p_j  = p_i,
\end{align*}
\]</span> which shows the statement of <a href="#lem-GenDiscrRV">Lemma&nbsp;<span>1.1</span></a>.</p>
<div id="exm-Bernoulli" class="theorem example">
<p><span class="theorem-title"><strong>Example 1.2 (Bernoulli Distribution) </strong></span>Generate random numbers from <span class="math display">\[
X\sim\mathrm{Bernoulli}(p),
\]</span> where <span class="math inline">\(p\)</span> is the probability of success, i.e., <span class="math display">\[
\mathbb{P}(X=1)=p\quad\text{and}\quad\mathbb{P}(X=0)=1-p.
\]</span></p>
<p><strong>Algorithm:</strong> If <span class="math inline">\(U\sim\mathcal{U}[0,1]\)</span> and <span class="math inline">\(p\)</span> is specified, define <span class="math display">\[
X=\left\{
  \begin{matrix}
  1 &amp; \text{if }U\leq p\\
  0 &amp; \text{otherwise}.\\
  \end{matrix}
\right.
\]</span> Then <span class="math inline">\(X\sim\mathrm{Bernoulli}(p)\)</span>.</p>
<div class="cell" data-hash="Ch1_Random_Variable_Generation_cache/html/unnamed-chunk-6_ef7b417f0369cc4c519dec2c6dd96f95">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate one random number from Bernoulli(p) with p=0.5</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>p  <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>U  <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(U<span class="sc">&lt;=</span>p) X<span class="ot">=</span><span class="dv">1</span> <span class="cf">else</span> X<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>X</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
</div>
<div id="exm-Binom" class="theorem example">
<p><span class="theorem-title"><strong>Example 1.3 (Binomial Distribution) </strong></span>Generate random numbers from <span class="math display">\[
X\sim\mathrm{Binomial}(n,p),
\]</span> where <span class="math inline">\(n\)</span> is the number of trials and <span class="math inline">\(p\)</span> the probability of success such that <span class="math display">\[
\mathbb{P}(X=i)=\binom{n}{i}p^i(1-p)^{n-1}
\]</span> for <span class="math inline">\(i=1,\dots,n.\)</span></p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>If <span class="math inline">\(X_1,\dots,X_n\overset{i.i.d}{\sim}\mathrm{Bernoulli}(p),\)</span> then <span class="math display">\[
X=\sum_{i=1}^nX_i \sim\mathrm{Binomial}(n,p).
\]</span></p>
</div>
</div>
<p><strong>Algorithm:</strong> If <span class="math inline">\(U_1,\dots,U_n\)</span> are i.i.d. as <span class="math inline">\(U\sim \mathcal{U}[0,1]\)</span> and <span class="math inline">\(n\)</span> and <span class="math inline">\(p\)</span> are specified, define <span class="math display">\[
X_i=\left\{
  \begin{matrix}
  1 &amp; \text{if }U_i\leq p\\
  0 &amp; \text{otherwise}.\\
  \end{matrix}
\right.
\]</span> Then <span class="math display">\[
X=\left(\sum_{i=1}^n X_i\right)\sim\mathrm{Binomial}(n,p).
\]</span></p>
<div class="cell" data-hash="Ch1_Random_Variable_Generation_cache/html/unnamed-chunk-7_1c11cecb4085f854644b236fa6c3abfb">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate one random number from B(n=10, p=0.5). </span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(U<span class="sc">&lt;=</span>p) X[i]<span class="ot">=</span><span class="dv">1</span> <span class="cf">else</span> X[i]<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">sum</span>(X)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>Y </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7</code></pre>
</div>
</div>
</div>
<div id="exm-Poisson" class="theorem example">
<p><span class="theorem-title"><strong>Example 1.4 (Poisson Distribution) </strong></span><strong>Algorithm:</strong> If <span class="math inline">\(U_1,\dots,U_n\)</span> are i.i.d. as <span class="math inline">\(U\sim \mathcal{U}[0,1]\)</span> and <span class="math inline">\(\lambda\)</span> is specified, define <span class="math display">\[
X=\min\left\{n=0,1,2\dots,\text{ such that }\prod_{i=1}^{n+1} U_i \leq e^{-\lambda}
\right\}.
\]</span> Then <span class="math display">\[
X=\left(\sum_{i=1}^n X_i\right)\sim\mathrm{Poisson}(\lambda).
\]</span></p>
<div class="cell" data-hash="Ch1_Random_Variable_Generation_cache/html/unnamed-chunk-8_6aea75f5c24f06bcb921b2208222780d">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate one random number from Poisson(lambda) </span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Initializations</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span>(U <span class="sc">&gt;</span> <span class="fu">exp</span>(<span class="sc">-</span>lambda)){</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  U <span class="ot">&lt;-</span> U <span class="sc">*</span> <span class="fu">runif</span>(<span class="dv">1</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> n<span class="dv">-1</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>n</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
</div>
</section>
<section id="generation-of-continuous-random-variables" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="generation-of-continuous-random-variables"><span class="header-section-number">1.3</span> Generation of Continuous Random Variables</h2>
<section id="the-inverse-method" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="the-inverse-method"><span class="header-section-number">1.3.1</span> The Inverse Method</h3>
<p>A rather general method to generate continuous random variables is the <strong>Inverse Method</strong>.</p>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">

</div>
</div>
<div class="callout-body-container callout-body">
<div id="thm-InverseMethod" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1.1 (Inverse Method) </strong></span>Let <span class="math inline">\(U\sim\mathcal{U}[0,1],\)</span> and let <span class="math inline">\(F_X\)</span> be an <strong>invertible</strong> distribution function. The transformed random variable<br>
<span class="math display">\[
X=F_X^{-1}(U)
\]</span> has then the distribution function <span class="math inline">\(F_X,\)</span> <span class="math display">\[
P(X\leq x) = F_X(x).
\]</span></p>
</div>
</div>
</div>
<div class="callout-important callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p><a href="#thm-InverseMethod">Theorem&nbsp;<span>1.1</span></a> can only be used to generate random variables <span class="math inline">\(X\)</span> with <strong>invertible</strong> distribution functions <span class="math inline">\(F_X.\)</span></p>
</div>
</div>
<p><strong>Proof:</strong></p>
<p>The distribution function of the transformed random variable <span class="math display">\[
X=F^{-1}(U)
\]</span> can be derived as <span class="math display">\[
\begin{align*}
\mathbb{P}(X\leq x)
&amp;= \mathbb{P}(F_X^{-1}(U)\leq x) \\
&amp;= \mathbb{P}(U\leq F_X(x)) \\
&amp;= F_U(F_X(x)) \\
&amp; = F_X(x),
\end{align*}
\]</span> which shows the result of <a href="#thm-InverseMethod">Theorem&nbsp;<span>1.1</span></a>. The last (and important) equality follows since the distribution function of <span class="math inline">\(U\sim\mathcal{U}[0,1]\)</span> is <span class="math display">\[
\mathbb{P}(U\leq u) = F_U(u) = u, \quad 0\leq u \leq 1
\]</span> since the distribution function <span class="math inline">\(F_U\)</span> of <span class="math inline">\(U\sim\mathcal{U}[0,1]\)</span> is <span id="eq-FUnif"><span class="math display">\[
F_U(u) = \left\{
  \begin{array}{ll}
  0 &amp; \text{for } u &lt; 0\\
  u &amp; \text{for } 0 \leq  u \leq 1\\
  1 &amp; \text{for } 1 &lt; u.\\
  \end{array}
\right.  
\tag{1.3}\]</span></span></p>
<!-- https://statproofbook.github.io/P/cdf-itm.html#:~:text=Proof%3A%20Inverse%20transformation%20method%20using%20cumulative%20distribution%20function&text=has%20a%20probability%20distribution%20characterized,)%20F%20X%20(%20x%20)%20.&text=U%E2%88%BCU(0%2C1,U%E2%89%A4u)%3Du. -->
<!-- http://www.columbia.edu/~ks20/4404-Sigman/4404-Notes-ITM.pdf -->
<div id="exm-Exponential" class="theorem example">
<p><span class="theorem-title"><strong>Example 1.5 (Exponential Distribution) </strong></span>Since <span class="math display">\[
F(x)= 1 - \exp(-\lambda x),
\]</span> we have <span class="math display">\[
F^{-1}(u) = - \frac{\ln(1-u)}{\lambda}.
\]</span></p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that <span class="math inline">\(1-U\)</span> has the same distribution as <span class="math inline">\(U\)</span>, if <span class="math inline">\(U\sim U[0,1]\)</span>. Therefore also <span class="math inline">\(-\frac{\ln(u)}{\lambda}\)</span> leads to a value from <span class="math inline">\(\mathrm{Exp}(\lambda).\)</span></p>
</div>
</div>
<p><strong>Algorithm:</strong> If <span class="math inline">\(U\sim \mathcal{U}[0,1]\)</span> and <span class="math inline">\(\lambda\)</span> is specified, define <span class="math display">\[
X=-\frac{\ln(U)}{\lambda}.
\]</span> Then <span class="math display">\[
X\sim \mathrm{Exp}(\lambda).
\]</span></p>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>The inverse method is mainly a good &amp; general way to think about transforming random variables, in practice, however, we often use other methods.</p>
<p>The inverse method often cannot be applied or is often inefficient, because the inverse of many important distribution functions cannot be derived in <a href="https://en.wikipedia.org/wiki/Closed-form_expression">closed form</a>:</p>
<ul>
<li>The Gaussian distribution function <span class="math inline">\(\Phi\)</span> and therefore also its inverse <span class="math inline">\(\Phi^{-1}\)</span> is not available in closed form.</li>
<li>For discontinuous random variables we need efficient algorithms for computing the <em>generalized</em> inverse of their distribution function <span class="math inline">\(F.\)</span></li>
</ul>
</div>
</div>
</section>
<section id="transformation-methods" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="transformation-methods"><span class="header-section-number">1.3.2</span> Transformation Methods</h3>
<p><strong>Idea:</strong> Construct algorithms from <a href="http://www.math.wm.edu/~leemis/2008amstat.pdf">theoretical links</a> between distributions.</p>
<p><strong>Pro:</strong> These methods can be advantageous if a distribution <span class="math inline">\(f\)</span> is linked (in a relatively simple way) to another distribution that is easy to simulate.</p>
<p><strong>Con:</strong> Generally, these methods are rather case-specific, and difficult to generalize.</p>
<div id="exm-BuildOnExp" class="theorem example">
<p><span class="theorem-title"><strong>Example 1.6 (Building on Exponential RVs) </strong></span>In <a href="#exm-Exponential">Example&nbsp;<span>1.5</span></a>, we learned to generate an exponential random variable <span class="math inline">\(X\sim\operatorname{Exp}(\lambda)\)</span> starting from a uniform random variable <span class="math inline">\(U\sim\mathcal{U}[0,1].\)</span> In the following we generate random variables starting from exponential random variables <span class="math inline">\(X\sim\mathrm{Exp}(1):\)</span></p>
<p>If the <span class="math inline">\(X_1, X_2,\dots\)</span> are i.i.d. as <span class="math inline">\(X\sim\mathrm{Exp}(1),\)</span> then</p>
<p><span class="math display">\[Y\sim \chi^2_{2\nu}\quad\text{if}       \quad Y= 2     \sum_{i=1}^\nu X_i,\quad\nu=1,2,\dots \]</span> <span class="math display">\[Y\sim \Gamma(\alpha,\beta)\quad\text{if}\quad Y= \beta \sum_{i=1}^\alpha X_i,\quad \alpha=1,2,\dots \]</span> <span class="math display">\[Y\sim \mathrm{Beta}(a,b)\quad\text{if}  \quad Y= \frac{\sum_{i=1}^a X_i}{\sum_{j=1}^{a+b} X_j},\quad a,b=1,2,\dots \]</span></p>
</div>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>There are better algorithms to generate Gamma and Beta random variables.</p>
<p>We cannot use exponential random variables to generate Gamma random variable with a non-integer shape parameter <span class="math inline">\(\alpha\)</span>.</p>
<ul>
<li><p>This implies that we cannot generate a <span class="math inline">\(\chi^2_{1}\)</span>-distributed random variable, because the <span class="math inline">\(\chi^2_{1}\)</span> distribution is identical to the <span class="math inline">\(\Gamma(\alpha, 2)\)</span> distribution with <span class="math inline">\(\alpha=\frac{1}{2}.\)</span></p></li>
<li><p>This then also implies that we cannot generate a <span class="math inline">\(\mathcal{N}(0,1)\)</span>-distrbuted random variable, since <span class="math inline">\(X^2\sim \chi^2_{1}\)</span> for <span class="math inline">\(X\sim\mathcal{N}(0,1)\)</span>.<br>
</p></li>
</ul>
</div>
</div>
<p>The well-known Box-Muller algorithm for generating standard normal random variables is based on the following theorem of <span class="citation" data-cites="BoxMuller1958">Box and Muller (<a href="#ref-BoxMuller1958" role="doc-biblioref">1958</a>)</span>:</p>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">

</div>
</div>
<div class="callout-body-container callout-body">
<div id="thm-NormalVariableGeneration" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1.2 (Normal Variable Generation (Box and Muller, 1958)) </strong></span>If <span class="math inline">\(U_1\)</span> and <span class="math inline">\(U_2\)</span> are i.i.d. as <span class="math inline">\(U\sim\mathcal{U}[0,1]\)</span>, then <span class="math display">\[
X_1 =\sqrt{-2 \ln(U_1)}\, \cos(2\pi U_2)
\]</span> and <span class="math display">\[
X_2=\sqrt{-2\ln(U_1)}\,\sin(2\pi U_2)
\]</span> are both i.i.d. as <span class="math inline">\(X\sim\mathcal{N}(0,1).\)</span></p>
</div>
</div>
</div>
<p><strong>Proof:</strong></p>
<p>Define the random variables <span class="math display">\[
R = \sqrt{-2 \ln(U_1)}\quad\text{and}\quad Q = 2\pi U_2,
\]</span> where <span class="math display">\[
R\in(0,\infty)\quad\text{and}\quad Q\in[0,2\pi].
\]</span></p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Idea of the proof:</strong></p>
<ol type="1">
<li>Derive the bivariate density of <span class="math inline">\((R, Q).\)</span></li>
<li>Determine the functional connection <span class="math inline">\(g\)</span> between <span class="math inline">\((R, Q)\)</span> and <span class="math inline">\((X_1, X_2)\)</span> and note that <span class="math inline">\(g\)</span> is invertible.</li>
<li>Use the <strong>transformation formula</strong> for densities to derive the bivariate density of <span class="math inline">\((X_1,X_2)\)</span> using <span class="math inline">\(g^{-1}\)</span> and the bivariate density of <span class="math inline">\((R, Q).\)</span></li>
<li>The result follows, if the bivariate density of <span class="math inline">\((X_1,X_2)\)</span> equals the product of two standard normal densities.</li>
</ol>
<p><strong>Transformation formula (bivariate case):</strong></p>
<p>Assume that the bivariate random variable <span class="math display">\[
\left(\begin{matrix}R\\ Q\end{matrix}\right)
\]</span> has a bivariate density <span class="math inline">\(f_{RQ}(r, q)\)</span> and that there is a mapping <span class="math inline">\(g\)</span> between the bivariate random variables <span class="math display">\[
\left(\begin{matrix}R\\ Q\end{matrix}\right)\text{ and }
\left(\begin{matrix}X_1\\ X_2\end{matrix}\right)
\]</span> such that <span class="math display">\[
\left(\begin{matrix}X_1\\ X_2\end{matrix}\right)=
g(R, Q)=
\left(\begin{matrix}g_1(R, Q)\\ g_2 (R, Q)\end{matrix}\right),
\]</span> where <span class="math inline">\(g:\mathbb{R}^2\to\mathbb{R}^2\)</span> is a differentiable and invertible function with inverse <span class="math inline">\(g^{-1}.\)</span></p>
<p>Then, the bivariate density of <span class="math inline">\(\left(\begin{matrix}X_1\\X_2\end{matrix}\right)\)</span> is given by <span id="eq-TransformFormula"><span class="math display">\[
f_{X_1X_2}(x_1,x_2)=f_{RQ}\left(g^{-1}(x_1,x_2)\right)\,\left|\det\left(J_{g^{-1}}(x_1,x_2)\right)\right|,
\tag{1.4}\]</span></span> where <span class="math display">\[
\det\left(J_{g^{-1}}(x_1,x_2)\right)
\]</span> denotes the determinant of the Jacobian matrix of <span class="math inline">\(g^{-1}\)</span> evaluated at <span class="math inline">\((x_1,x_2),\)</span> <span class="math display">\[
J_{g^{-1}}(x_1,x_2)=\left(\begin{matrix}
\frac{\partial g_1^{-1}}{\partial x_1}(x_1,x_2) &amp; \frac{\partial g_1^{-1}}{\partial x_2}(x_1,x_2)\\
\frac{\partial g_2^{-1}}{\partial x_1}(x_1,x_2) &amp; \frac{\partial g_2^{-1}}{\partial x_2}(x_1,x_2)\\
\end{matrix}\right).
\]</span> Note that the Jacobian of <span class="math inline">\(g^{-1}\)</span> equals the inverse of the Jacobian of <span class="math inline">\(g,\)</span> <span class="math display">\[
J_{g^{-1}}(x_1,x_2) = \left(J_{g}(r,q)\right)^{-1},
\]</span> with points <span class="math inline">\((x_1,x_2)\)</span> and <span class="math inline">\((r,q)\)</span> such that <span class="math display">\[
\left(\begin{matrix}x_1\\ x_2\end{matrix}\right)=
g(r, q)=
\left(\begin{matrix}g_1(r, q)\\ g_2 (r, q)\end{matrix}\right),
\]</span></p>
</div>
</div>
<p>We can derive the distribution function of <span class="math inline">\(R\)</span> as following <span class="math display">\[
\begin{align*}
F_R(r)=\mathbb{P}\left(R\leq r\right)
&amp; = \mathbb{P}\left(\sqrt{-2 \ln(U_1)}\leq r\right) \\
&amp; = \mathbb{P}\left(\ln(U_1)\geq -\frac{r^2}{2}\right) \\
&amp; = 1 - \mathbb{P}\left(\ln(U_1) &lt; -\frac{r^2}{2}\right) \\
&amp; = 1 - \mathbb{P}\left(\ln(U_1) \leq -\frac{r^2}{2}\right) \quad \text{(continous)}\\
&amp; = 1 - \mathbb{P}\left(U_1 \leq \exp\left(-\frac{r^2}{2}\right)\right) \\
&amp; = 1 - F_U\left(\exp\left(-\frac{r^2}{2}\right)\right)\\
&amp; = 1 - \exp\left(-\frac{r^2}{2}\right),
\end{align*}
\]</span> where the last step follows from applying the distribution <span class="math inline">\(F_U\)</span> of <span class="math inline">\(U\sim\mathcal{U}[0,1];\)</span> see <a href="#eq-FUnif">Equation&nbsp;<span>1.3</span></a>.</p>
<p>For the density function <span class="math inline">\(f_R\)</span> of <span class="math inline">\(R\)</span> we get <span class="math display">\[
f_R(r)=F_R'(r)=\left\{
  \begin{array}{ll}
  \exp\left(-\frac{r^2}{2}\right)\cdot r&amp;\text{for }r \in(0,\infty)\\
  0&amp;\text{otherwise}\\
  \end{array}\right.
\]</span> Next, we derive the density function of <span class="math display">\[
Q = 2\pi U_2.
\]</span> Since <span class="math inline">\(U_2\sim\mathcal{U}[0,1],\)</span> <span class="math display">\[
Q\sim\mathcal{U}[0,2\pi].
\]</span> with density function <span class="math display">\[
f_Q(q)=\left\{
  \begin{array}{ll}
  \frac{1}{2\pi}&amp;\text{for } q\in [0, 2\pi] \\
  0&amp;\text{otherwise}.\\
  \end{array}\right.
\]</span> Since <span class="math inline">\(U_1\)</span> and <span class="math inline">\(U_2\)</span> are independent, <span class="math inline">\(R=\sqrt{-2 \ln(U_1)}\)</span> and <span class="math inline">\(Q = 2\pi U_2\)</span> must also be independent, such that <span class="math display">\[
\begin{align*}
f_{RQ}(r,q)
&amp; = f_R(r)\cdot f_Q(q) \\
&amp; = \left\{
  \begin{array}{ll}
  \exp\left(-\frac{r^2}{2}\right) r\cdot \frac{1}{2\pi} &amp; \text{for } (r,q) \in (0,\infty)\times [0, 2\pi] \\
  0&amp;\text{otherwise}.\\
  \end{array}\right.
\end{align*}
\]</span><br>
Now, as we know the bivariate density of <span class="math inline">\((R,Q)\)</span> we can use the functional connection <span class="math display">\[
\begin{align*}
\left(\begin{matrix}X_1\\ X_2\end{matrix}\right)
&amp; = g(R,Q) \\
&amp; = \left(\begin{matrix}
       g_1(R,Q)\\
       g_2(R,Q)\end{matrix}\right)
= \left(\begin{matrix}
  R\cos(Q)\\
  R\sin(Q)
  \end{matrix}\right)
% &amp; = \left(\begin{matrix}
%   \sqrt{-2\ln(U_1)}\cos\left(2\pi U_2\right)\\
%   \sqrt{-2\ln(U_1)}\sin\left(2\pi U_2\right)\\
%   \end{matrix}\right)\\
\end{align*}
\]</span> with <span class="math display">\[
R = \sqrt{-\ln(U_1)}\in (0,\infty)
\]</span> and <span class="math display">\[
Q=2\pi U_2\in[0, 2\pi].
\]</span> <!-- $$
\begin{align*}
\left(\begin{matrix}x_1\\ x_2\end{matrix}\right) 
&=  g(r,q)\\
& = \left(\begin{matrix}g_1(r,q)\\g_2(r,q)\end{matrix}\right)\\
& = \left(\begin{matrix}r\cos(q)\\r\sin(q)\end{matrix}\right) 
\end{align*}
$$
for all $r\in [0,\infty)$ and all $q\in[0, 2\pi].$ --></p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that, <span class="math inline">\(g\)</span> is just the one-to-one transformation that maps points <span class="math inline">\((r,q)\)</span> of the polar coordinate system</p>
<ul>
<li><strong>radius</strong> <span class="math inline">\(r\in (0,\infty)\)</span> and</li>
<li><strong>angle</strong> <span class="math inline">\(q\in[0, 2\pi]\)</span></li>
</ul>
<p>to points <span class="math inline">\((x_1,x_2)\)</span> of the Cartesian coordinate system: <span class="math display">\[
\begin{align*}
\left(\begin{matrix}x_1\\ x_2\end{matrix}\right)
&amp; = g(r,q)\\
&amp; = \left(\begin{matrix}g_1(r,q) \\ g_2(r,q)\end{matrix}\right)
= \left(\begin{matrix}r\cos(q)\\r\sin(q)\end{matrix}\right)
\end{align*}
\]</span></p>
<p>Play around with this mapping here: <a href="https://mathinsight.org/applet/polar_coordinates_map_rectangle">https://mathinsight.org/applet/polar_coordinates_map_rectangle</a></p>
<p>The inverse mapping <span class="math inline">\(g^{-1}\)</span> maps points <span class="math inline">\((x_1,x_2)\)</span> from the Cartesian coordinate system to points <span class="math inline">\((r,q)\)</span> in the polar coordinate system <span class="math display">\[
\begin{align*}
\left(\begin{matrix}r\\ q\end{matrix}\right)
&amp; = g^{-1}(x_1,x_2)\\
&amp; = \left(\begin{matrix}g_1^{-1}(x_1,x_2) \\ g_2^{-1}(x_1,x_2)\end{matrix}\right)
= \left(\begin{matrix}\sqrt{x_1^2 + x_2^2}\\ \operatorname{atan2}(x_1,x_2)
\end{matrix}\right),
\end{align*}
\]</span> where the function <span class="math inline">\(\operatorname{atan2}\)</span> is the <a href="https://en.wikipedia.org/wiki/Atan2">2-argument arctangent</a>. <!-- where the Jacobian determinant of $g^{-1}$ is given by (derivation is a little cumbersome)
$$
\left|J_{g^{-1}}(r,q)\right| = r.
$$ --></p>
</div>
</div>
<p><span class="math display">\[
\begin{align*}
J_{g^{-1}}(x_1,x_2)
&amp;=\left(J_{g}(r,q)\right)^{-1}\\
&amp;=\left(\begin{matrix}
\frac{\partial g_1}{\partial r}(r,q) &amp; \frac{\partial g_1}{\partial q}(r,q)\\
\frac{\partial g_2}{\partial r}(r,q) &amp; \frac{\partial g_2}{\partial q}(r,q)\\
\end{matrix}\right)^{-1}\\
&amp;=\left(\begin{matrix}
\cos(q) &amp; -r\sin(q)\\
\sin(q) &amp; \phantom{-}r\cos(q)\\
\end{matrix}\right)^{-1}\\
&amp;=
\frac{1}{r\cos^2(q) + r\sin^2(q)}
\left(\begin{matrix}
r\cos(q) &amp; r\sin(q)\\
-\sin(q) &amp;  \cos(q)\\
\end{matrix}\right)\\
&amp;=
\frac{1}{r}
\left(\begin{matrix}
r\cos(q) &amp; r\sin(q)\\
-\sin(q) &amp;  \cos(q)\\
\end{matrix}\right)
\end{align*},
\]</span> where the last step follows from <a href="https://en.wikipedia.org/wiki/Pythagorean_trigonometric_identity">Pythagorean’s identity</a> <span class="math inline">\(\cos^2(q) + \sin^2(q)=1.\)</span> So <span class="math display">\[
\begin{align*}
\left|\operatorname{det}\left(J_{g^{-1}}(x_1,x_2)\right)\right|
&amp;=\left|\operatorname{det}\left(\left(J_{g}(r,q)\right)^{-1}\right)\right|\\
&amp;=
\left|\operatorname{det}\left(
  \begin{matrix}
            \cos(q) &amp;            \sin(q)\\
-\frac{1}{r}\sin(q) &amp; \frac{1}{r}\cos(q)\\
\end{matrix}\right)
\right|\\
&amp;=
\left|\frac{1}{r}\cos^2(q) + \frac{1}{r}\sin^2(q)\right| = \frac{1}{r},
\end{align*}
\]</span> again using <a href="https://en.wikipedia.org/wiki/Pythagorean_trigonometric_identity">Pythagorean’s identity</a> <span class="math inline">\(\cos^2(x_2) + \sin^2(x_2)=1\)</span> and using that <span class="math inline">\(r\in(0,\infty).\)</span></p>
<p>Thus, by the transformation formula for bivariate densities (<a href="#eq-TransformFormula">Equation&nbsp;<span>1.4</span></a>), we have <span class="math display">\[
\begin{align*}
f_{X_1X_2}(x_1,x_2)
&amp;=f_{RQ}\left(g^{-1}(x_1,x_2)\right)\left|\operatorname{det}\left(J_{g^{-1}}(x_1,x_2)\right)\right|\\
&amp;=f_{RQ}\Big(\underbrace{\sqrt{x_1^2+x_2^2}}_{=r},\underbrace{\operatorname{atan2}(x_1,x_2)}_{=q}\Big)\frac{1}{r}\\
&amp;=\exp\left(-\frac{x_1^2+x_2^2}{2}\right) \sqrt{x_1^2+x_2^2} \cdot \frac{1}{2\pi} \frac{1}{r}\\
&amp;=\exp\left(-\frac{x_1^2+x_2^2}{2}\right)  \frac{1}{2\pi},
\end{align*}
\]</span> where the last step uses that <span class="math inline">\(r=\sqrt{x_1^2+x_2^2}.\)</span></p>
<p>This shows the result of <a href="#thm-NormalVariableGeneration">Theorem&nbsp;<span>1.2</span></a>, since the bivariate density of <span class="math inline">\((X_1,X_2)\)</span> equals the product of two marginal standard normal density functions, <span class="math display">\[
\begin{align*}
f_{X_1X_2}(x_1,x_2)
&amp; = \frac{1}{2\pi}\exp\left(-\frac{x_1^2+x_2^2}{2}\right) \\
&amp; = \underbrace{\frac{1}{\sqrt{2\pi}}\exp\left(-\frac{x_1^2}{2}\right)}_{=\phi(x_1)} \cdot
    \underbrace{\frac{1}{\sqrt{2\pi}}\exp\left(-\frac{x_2^2}{2}\right)}_{=\phi(x_2)},
\end{align*}
\]</span> where <span class="math inline">\(\phi\)</span> denotes the density function of the standard normal distribution <span class="math inline">\(\mathcal{N}(0,1)\)</span>.</p>
<p><strong>Implementation</strong> of the Box-Muller algorithm:</p>
<div class="cell" data-layout-align="center" data-hash="Ch1_Random_Variable_Generation_cache/html/unnamed-chunk-9_d38b76ceaba345762a456054b7214b15">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Implementation:</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>BM_Algo <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Generate U_1, U_2 iid U[0,1]</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">2</span>)</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Transformation</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U[<span class="dv">1</span>])) <span class="sc">*</span> <span class="fu">cos</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> U[<span class="dv">2</span>])</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  X2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(U[<span class="dv">1</span>])) <span class="sc">*</span> <span class="fu">sin</span>(<span class="dv">2</span> <span class="sc">*</span> pi <span class="sc">*</span> U[<span class="dv">2</span>])</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Return result</span></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(X1, X2))</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Generate n standard normal random variables:</span></span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">321</span>)</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>n     <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>X_vec <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> n, <span class="at">mode =</span> <span class="st">"double"</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, n, <span class="at">by=</span><span class="dv">2</span>)){</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  X_vec[<span class="fu">c</span>(i, i<span class="sc">+</span><span class="dv">1</span>)] <span class="ot">&lt;-</span> <span class="fu">BM_Algo</span>()</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Descriptive Plots</span></span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X_vec, <span class="at">freq =</span> <span class="cn">FALSE</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>))</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(dnorm, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">lwd=</span><span class="fl">1.3</span>)</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a><span class="fu">qqnorm</span>(X_vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="Ch1_Random_Variable_Generation_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Testing for Normality using the Shapiro-Wilk Test </span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co"># H0: Normality</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(X_vec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  X_vec
W = 0.99882, p-value = 0.7667</code></pre>
</div>
</div>
<div class="cell" data-hash="Ch1_Random_Variable_Generation_cache/html/unnamed-chunk-10_1e525beb0a6dc15dc682b810ed933d9a">

</div>
<p>That is, the Shapiro Wilk is not able to reject its null-hypothesis that the data comes from a normal distribution. However, this was only a single test result and the results may differ in other samples. So, let’s check the test results across <span class="math inline">\(B=5000\)</span> samples.</p>
<div class="cell" data-hash="Ch1_Random_Variable_Generation_cache/html/unnamed-chunk-11_550f263d82edccbdd598641adfe85673">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Monte Carlo (MC) replications</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>B     <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Sample size</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>n     <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Significance level</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Container vectors</span></span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>X_vec <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> n, <span class="at">mode =</span> <span class="st">"double"</span>)</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>T_vec <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> B, <span class="at">mode =</span> <span class="st">"logical"</span>)</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a><span class="do">## MC-Simulation</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B){ </span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, n, <span class="at">by=</span><span class="dv">2</span>)){</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>    X_vec[<span class="fu">c</span>(i, i<span class="sc">+</span><span class="dv">1</span>)] <span class="ot">&lt;-</span> <span class="fu">BM_Algo</span>()</span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Collect test decisions</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  tmp      <span class="ot">&lt;-</span> <span class="fu">shapiro.test</span>(X_vec)</span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  T_vec[b] <span class="ot">&lt;-</span> tmp<span class="sc">$</span>p.value <span class="sc">&lt;</span> alpha</span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">mean</span>(T_vec), <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05</code></pre>
</div>
</div>
<p>It turns out that the false positive rate (empirical frequency of Type I errors) of the Shapiro Wilk test equals the chosen significance level <span class="math inline">\(\alpha.\)</span> That is, the test is not able to reject its null-hypothesis (“normal distribution”) beyond the expected frequency of a Type I error.</p>
</section>
<section id="accept-reject-methods" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="accept-reject-methods"><span class="header-section-number">1.3.3</span> Accept-Reject Methods</h3>
<p>For many distributions <span class="math inline">\(F\)</span> it is difficult (or impossible) to apply the Inverse Method or some Transformation Method, since the distribution function <span class="math inline">\(F\)</span> is somehow “unsuitable”. For instance, surprisingly often there is no explicit form of <span class="math inline">\(F\)</span> available or its inverse does not exists.</p>
<p>Accept-Reject Methods methods can provide a solution here, since they only require the knowledge of the functional form of the density <span class="math inline">\(f\)</span> of interest—actually, <span class="math inline">\(f\)</span> needs to be known only up to a multiplicative constant. No deep analytic study of <span class="math inline">\(f\)</span> is necessary.</p>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">

</div>
</div>
<div class="callout-body-container callout-body">
<div id="thm-FundamentalThmSimulation" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1.3 (Fundamental Theorem of Simulation) </strong></span>Let <span class="math inline">\(X\in\mathbb{R}^d\)</span> be a random variable with density function <span class="math inline">\(f_X,\)</span> <span class="math display">\[
X\sim f_X.
\]</span> Then simulating <span class="math inline">\(X\)</span> is equivalent to simulating <span class="math inline">\((X,U)\in\mathbb{R}^{d+1},\)</span><br>
<span class="math display">\[
(X,U)\sim\mathcal{U}(\mathcal{A}),
\]</span> where <span class="math inline">\(\mathcal{U}(\mathcal{A})\)</span> denotes the uniform distribution over the area <span class="math display">\[
\mathcal{A}=\left\{(x,u)\;|\; x\in\mathbb{R}^d \text{ and } 0&lt;u&lt;f_X(x)\right\}.
\]</span></p>
</div>
</div>
</div>
<p><a href="#fig-FundThmSim">Figure&nbsp;<span>1.2</span></a> visualizes the statement of <a href="#thm-FundamentalThmSimulation">Theorem&nbsp;<span>1.3</span></a> for the univariate <span class="math inline">\((d=1)\)</span> case.</p>
<div class="cell" data-hash="Ch1_Random_Variable_Generation_cache/html/fig-FundThmSim_6b81ea9543033b182feb1528b659bac1">
<div class="cell-output-display">
<div id="fig-FundThmSim" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Ch1_Random_Variable_Generation_files/figure-html/fig-FundThmSim-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1.2: To simulate a random variable <span class="math inline">\(X,\)</span> one can simulate <span class="math inline">\((X,U)\)</span> uniformely over <span class="math inline">\(\mathcal{A},\)</span> and then take those <span class="math inline">\(X\)</span> realizations (tick-marks at <span class="math inline">\(x\)</span>-axis) as simulation results.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<p>It turns out that sampling <span class="math inline">\((X, U)\)</span> uniformly over the set <span class="math inline">\(\mathcal{A}\)</span> is often challenging. However, one can consider some superset <span class="math inline">\(\mathcal{S},\)</span> <span class="math display">\[
\mathcal{A}\subseteq \mathcal{S},
\]</span> such that simulating a random variable uniformly distributed over <span class="math inline">\(\mathcal{S}\)</span> is easy.</p>
<p>A uniform distribution on <span class="math inline">\(\mathcal{A}\)</span> can then be obtained by</p>
<ol type="1">
<li>drawing from a uniform distribution on <span class="math inline">\(\mathcal{S}\)</span> and</li>
<li>rejecting samples that are in <span class="math inline">\(\mathcal{S},\)</span> but not in <span class="math inline">\(\mathcal{A}.\)</span></li>
</ol>
<section id="sec-ARd1compact" class="level4" data-number="1.3.3.1">
<h4 data-number="1.3.3.1" class="anchored" data-anchor-id="sec-ARd1compact"><span class="header-section-number">1.3.3.1</span> The case of bounded densities with compact support</h4>
<p>The general principle of the accept-reject method is easily explained using a <em>bounded</em> density function <span class="math inline">\(f\)</span> with <em>compact support</em>.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><strong>Bounded</strong> (from above) means that there exists a constant <span class="math inline">\(m\)</span> with <span class="math inline">\(0&lt;m&lt;\infty\)</span> such that <span class="math display">\[
\sup_xf(x)\leq m
\]</span></p></li>
<li><p>An interval <span class="math inline">\([a,b]\)</span> is called <strong>compact</strong> if it is closed and the boundaries are finite. For instance, the Gaussian density <span class="math inline">\(\phi\)</span> has <em>not</em> a compact support, but <span class="math inline">\(\mathrm{supp}(\phi)=(-\infty,\infty)\)</span>.</p></li>
<li><p>Examples:</p>
<ul>
<li>A <strong>bounded</strong> density function with <strong>compact support</strong>: <span class="math display">\[
f_c(x)=\frac{3}{4}\left(1-\left(x-c\right)^2\right)\,1_{(|x-c|\leq 1)},
\]</span> where the (compact) support of <span class="math inline">\(f\)</span> is <span class="math inline">\([a,b]=[c-1,c+1]\)</span> and its range is <span class="math inline">\([0,m]=[0,3/4]\)</span>, i.e., <span class="math inline">\(f_c\)</span> is bounded from above by <span class="math inline">\(3/4\)</span> for all <span class="math inline">\(c\in\mathbb{R}.\)</span> <!-- (Yes, it's a stupid example as we do not necessarily need the Accept-Reject Method here.) --></li>
<li>An <strong>unbounded</strong> density function with <strong>compact support</strong>: <span class="math display">\[
f(x)=\left\{
\begin{array}{ll}
\frac{x}{b^2}\left(1-\frac{x^2}{b^2}\right)^{-1/2}&amp;\text{ for }x\in(0,b)\\
0&amp;\text{ otherwise}
\end{array}
\right.
\]</span> <span class="math inline">\(f(x)\)</span> is <span class="math inline">\(0\)</span> for <span class="math inline">\(x=0,\)</span> but diverges to positive infinity for <span class="math inline">\(x\to b.\)</span></li>
</ul></li>
</ul>
</div>
</div>
<p><strong>The Accept-Reject Algorithm for bounded densities with compact support:</strong></p>
<ul>
<li><p><strong>Compact support:</strong> Let <span class="math display">\[
\operatorname{supp}(f)=[a_1,b_1]\times \dots\times[a_d,b_d],
\]</span> where <span class="math inline">\([a_j,b_j]\subseteq\mathbb{R}\)</span> are compact intervals for each <span class="math inline">\(j=1,\dots,d.\)</span></p></li>
<li><p><strong>Bounded (from above):</strong> Let <span class="math display">\[
\sup_{x\in[a_1,b_1]\times \dots\times[a_d,b_d]} f(x)\leq m,
\]</span> where <span class="math inline">\(m\)</span> is a constant with <span class="math inline">\(0&lt;m&lt;\infty.\)</span></p></li>
</ul>
<p>To simulate <span class="math display">\[
X\sim f_X
\]</span> simulate the random pair <span class="math display">\[
(Y,U)\sim\mathcal{U}\big(\underbrace{[a_1,b_1]\times \dots\times[a_d,b_d] \times[0,m]}_{=\mathcal{S}}\big)
\]</span> by simulating independently <span class="math display">\[
Y\sim\mathcal{U}([a_1,b_1]\times \dots\times[a_d,b_d])
\]</span> and <span class="math display">\[
U \sim \mathcal{U}[0,m].
\]</span></p>
<p><strong>Accept-Reject Step:</strong></p>
<p><strong>Accept</strong> a simulated <span class="math inline">\(Y\)</span> as a simulation for <span class="math inline">\(X\)</span>, i.e.&nbsp;set <span class="math display">\[
X=Y,
\]</span> <strong>only if</strong> <span class="math display">\[
U\leq f_X(Y),
\]</span> and <strong>reject</strong> all other <span class="math inline">\(Y\)</span>’s.</p>
<!-- ::: {.callout-tip}
Simulating 
$$
U|Y=y \sim \mathcal{U}[0,m]
$$ 
is particularly simple, since the conditional random variable $U|Y$ does here not depend on $Y$ and thus has the same distribution as the **unconditional** random variable 
$$
U|Y \sim U,
$$
where $U\sim\mathcal{U}[0,m].$ 
::: -->
<div id="exm-ARAlgo1Example" class="theorem example">
<p><span class="theorem-title"><strong>Example 1.7 </strong></span>Let the target density be <span class="math display">\[
f_X(x)=\frac{3}{4} \left(1-x^2\right)\mathbf{1}_{(|x|\leq 1)},
\]</span> where <span class="math display">\[
\operatorname{supp}(f_X)=[-1,1]
\]</span> and <span class="math display">\[
\sup_{x\in[-1,1]}f_X(x)\leq\frac{3}{4}.
\]</span> Thus the Accept-Reject algorithm for simulating <span class="math inline">\(X\sim f_X\)</span> can be implemented by generating<br>
<span class="math display">\[
(Y,X)\sim\mathcal{U}([-1,1]\times[0,3/4])
\]</span> and accepting <span class="math inline">\(Y\)</span> as realizations of <span class="math inline">\(X\)</span> only if <span class="math inline">\(U\leq f_X(Y).\)</span></p>
</div>
<p>Look at the following code. It’s a very simple algorithm, where we effectively only need to evaluate the density function <span class="math inline">\(f_X,\)</span> <code>target_pdf</code>:</p>
<div class="cell" data-hash="Ch1_Random_Variable_Generation_cache/html/unnamed-chunk-13_833cdbdeb62791584c9bf67aafa96576">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Target pdf f_X</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>target_pdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  pdf <span class="ot">&lt;-</span> (<span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>(x)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  pdf[(x)<span class="sc">^</span><span class="dv">2</span> <span class="sc">&gt;</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">##</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pdf)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Accept-Reject Algo:</span></span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1000</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>) </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1000</span>, <span class="at">min =</span>  <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span>) </span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a><span class="co"># A-R Step:</span></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>accept <span class="ot">&lt;-</span> U <span class="sc">&lt;=</span> <span class="fu">target_pdf</span>(Y)</span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>X      <span class="ot">&lt;-</span> Y[accept]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><a href="#fig-ARExample1">Figure&nbsp;<span>1.3</span></a> illustrates <a href="#exm-ARAlgo1Example">Example&nbsp;<span>1.7</span></a>.</p>
<div class="cell" data-hash="Ch1_Random_Variable_Generation_cache/html/fig-ARExample1_71ddb21035f9ed797e18f7a67b6a3fc8">
<div class="cell-output-display">
<div id="fig-ARExample1" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Ch1_Random_Variable_Generation_files/figure-html/fig-ARExample1-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1.3: Accept-Reject algorithm for univariate <span class="math inline">\((d=1)\)</span> bounded densities with compact support.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-hash="Ch1_Random_Variable_Generation_cache/html/unnamed-chunk-15_3522c318e4068fba61b96d2c3c5447ab">

</div>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">

</div>
</div>
<div class="callout-body-container callout-body">
<div id="thm-ARAlgo1" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1.4 (Accept-Reject Algorithm bounded density functions with compact support.) </strong></span>Let <span class="math inline">\(f_X\)</span> be a <span class="math inline">\(d\)</span>-dimensional density function with</p>
<ul>
<li>compact support <span class="math inline">\(\operatorname{supp}(f)=[a_1,b_1]\times \dots\times[a_d,b_d]\subseteq\mathbb{R}^d,\)</span> and</li>
<li>bounded from above <span class="math inline">\(\sup_{x\in[a_1,b_1]\times \dots\times[a_d,b_d]}f_X(x)\leq m\)</span> with <span class="math inline">\(0&lt;m&lt;\infty.\)</span></li>
</ul>
<p>Then the Accept-Reject algorithm as introduced in <a href="#sec-ARd1compact"><span>Section&nbsp;1.3.3.1</span></a> allows to simulate <span class="math display">\[
X\sim f_X.
\]</span></p>
</div>
</div>
</div>
<p><strong>Proof</strong> of <a href="#thm-ARAlgo1">Theorem&nbsp;<span>1.4</span></a> for the case <span class="math inline">\(d=1\)</span>:</p>
<p>The following derivation shows that the Accept-Reject algorithm as introduced in <a href="#sec-ARd1compact"><span>Section&nbsp;1.3.3.1</span></a> allows to simulate random variables <span class="math inline">\(X\)</span> with the correct target distribution <span class="math inline">\(F_X(x)=\int_a^xf_X(x)dx.\)</span></p>
<p><span class="math display">\[
\begin{align*}
\mathbb{P}(X\leq x)
&amp;=\mathbb{P}(Y\leq x|U\leq f_X(Y))\\[2ex]
&amp;= \frac{\mathbb{P}(Y\leq x, U\leq f_X(Y))}{\mathbb{P}(U\leq f_X(Y))}\\[2ex]
&amp;= \frac{\mathbb{P}(a\leq Y\leq x, \; 0\leq U\leq f_X(Y))}{\mathbb{P}(0\leq U\leq f_X(Y))}\\[2ex]
&amp; =\frac{\int_a^{x} \int_0^{f_X(y)}\,c\;du\,dy}{\int_a^{b}\int_0^{f_X(y)}\,c\;du\,dy},
\end{align*}
\]</span> where the constant <span class="math inline">\(c\)</span> is the normalizing constant, i.e., the height of the uniform density function uniquely determined by the equation <span class="math display">\[
\int_a^{b} \int_0^{m}\,c\,du\,dy = 1,
\]</span> but which is irrelevant here since <span class="math display">\[
\begin{align*}
\mathbb{P}(X\leq x)
&amp; =\frac{c\;\int_a^{x} \int_0^{f_X(y)}\,1\;du\,dy}{c\;\int_a^{b}\int_0^{f_X(y)}\,1\;du\,dy}\\[2ex]
&amp; =\frac{\int_a^{x} \int_0^{f_X(y)}\,1\;du\,dy}{\int_a^{b}\int_0^{f_X(y)}\,1\;du\,dy}.\\
\end{align*}
\]</span> Now, using that <span class="math inline">\(\int_{0}^{f_X(y)}1du=\big[x\big]^{f_X(y)}_0=f_X(y)\)</span> yields <span class="math display">\[
\begin{align*}
\mathbb{P}(X\leq x)
&amp; =\frac{\int_a^x f_X(y)\,dy}{\int_a^b f_X(y)\,dy}\\[2ex]
&amp; =\int_a^x f_X(y)dy = F_X(x),
\end{align*}
\]</span> which completes the proof.</p>
</section>
<section id="sec-ARd1noncompact" class="level4" data-number="1.3.3.2">
<h4 data-number="1.3.3.2" class="anchored" data-anchor-id="sec-ARd1noncompact"><span class="header-section-number">1.3.3.2</span> The case of densities with non-compact support</h4>
<p>If <span class="math inline">\(f_X\)</span> has no compact support, the larger set <span class="math inline">\(\mathcal{S}\)</span> does not necessarily need to be a surrounding closed box as used above. In fact, it can be any “larger set” <span class="math inline">\(\mathcal{S},\)</span> enclosing the density function <span class="math inline">\(f_X\)</span>, as long as simulating uniformly over this larger set <span class="math inline">\(\mathcal{S}\)</span> is feasible. This generalization allows for cases, where the support of <span class="math inline">\(f_X\)</span> is <strong>not compact</strong> (i.e.&nbsp;unbounded).</p>
<p>Let the larger set denote by <span class="math display">\[
\mathcal{S}=\{(y,u)\;|\;y\in\mathbb{R}^d\text{ and } 0\leq u\leq m(y)\},
\]</span> where:</p>
<ul>
<li><p>simulation of a uniform on <span class="math inline">\(\mathcal{S}\)</span> is <strong>feasible</strong> and</p></li>
<li><p><span class="math inline">\(f_X(x)\leq m(x)\)</span> for all <span class="math inline">\(x\in\mathbb{R}^d.\)</span></p></li>
</ul>
<p>From the <strong>feasibility-requirement</strong> it follows that the function <span class="math inline">\(m\)</span> is necessarily integrable, i.e., that <span class="math display">\[
\int\dots \int m(x_1,\dots,x_d)dx_1\dots dx_d=M,
\]</span> or short with <span class="math inline">\(x=(x_1,\dots,x_d)\)</span> and <span class="math inline">\(X\in\mathbb{R}^d\)</span> <span class="math display">\[
\int_{\mathbb{R}^d} m(x)dx=M,
\]</span> where <span class="math inline">\(M\)</span> exists and is finite (and positive), since otherwise, <span class="math inline">\(\mathcal{S}\)</span> would not have finite mass and a uniform distribution would not exists on <span class="math inline">\(\mathcal{S}\)</span>.</p>
<p>Integrability of <span class="math inline">\(m\)</span> is crucial here, since it allows us to relate the function <span class="math inline">\(m\)</span> with a corresponding (auxiliary) density function <span class="math inline">\(g\)</span> as following: <span class="math display">\[
m(x)=M\,g(x),
\]</span> where <span class="math display">\[
\int_{\mathbb{R}^d} m(x)\,dx=\int_{\mathbb{R}^d} M\,g(x)\,dx=M.
\]</span> Therefore, a uniform distribution over <span class="math inline">\(\mathcal{S},\)</span> <span class="math display">\[
\mathcal{U}\big(\underbrace{\{(y,u)\;|\;y\in\mathbb{R}^d\text{ and } 0\leq u\leq m(y)\}}_{\mathcal{S}}\big)
\]</span> has a <strong>density function</strong> that is equal to <span class="math display">\[
\frac{1}{M}
\]</span> for all points <span class="math inline">\((y,u)\in\mathcal{S}\)</span> and zero else—otherwise the density would not integrate to one.</p>
<p>Terminology:</p>
<ul>
<li><p>The density function <span class="math inline">\(g\)</span> is called the <strong>instrumental density</strong>. (Choose <span class="math inline">\(g\)</span> as a density from which it is easy to simulate!)</p></li>
<li><p>The density function <span class="math inline">\(f_X\)</span> is called the <strong>target density</strong>.</p></li>
</ul>
<p><strong>The Accept-Reject Algorithm for densities with non-compact support:</strong></p>
<p>To simulate <span class="math display">\[
X\sim f_X
\]</span> simulate the <span class="math inline">\((d+1)\)</span>-dimensional random variable<br>
<span class="math display">\[
(Y,U)\sim\mathcal{U}\big(\underbrace{\{(y,u)\;|\;y\in\mathbb{R}^d\text{ and } 0\leq u\leq m(y)\}}_{\mathcal{S}}\big)
\]</span> by simulating</p>
<ol type="1">
<li>a realization of <span class="math display">\[
Y\sim g
\]</span> and</li>
<li>for a given realization <span class="math inline">\(Y={\color{red}y},\)</span> a realization of<br>
<span class="math display">\[
U|Y={\color{red}y}\sim\mathcal{U}[0,M\,g({\color{red}y})].
\]</span></li>
</ol>
<p><strong>Accept-Reject Step:</strong></p>
<p><strong>Accept</strong> a simulated <span class="math inline">\(Y\)</span> as a simulation for <span class="math inline">\(X\)</span>, i.e.&nbsp;set <span class="math display">\[
X=Y
\]</span> <strong>only if</strong> <span class="math display">\[
U\leq f_X(Y)
\]</span> and <strong>reject</strong> all other <span class="math inline">\(Y\)</span>’s.</p>
<div class="callout-note callout callout-style-default no-icon callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-caption-container flex-fill">

</div>
</div>
<div class="callout-body-container callout-body">
<div id="thm-ARAlgo2" class="theorem">
<p><span class="theorem-title"><strong>Theorem 1.5 (Accept-Reject Algorithm bounded density functions with non-compact support.) </strong></span>Let <span class="math inline">\(f_X\)</span> be a <span class="math inline">\(d\)</span>-dimensional density function and let <span class="math inline">\(m(x)=Mg(x)\)</span> such that <span class="math inline">\(g\)</span> is a <span class="math inline">\(d\)</span>-dimensional auxiliary density function with</p>
<ul>
<li><span class="math inline">\(\int m(x)dx=\int Mg(x)dx = M\)</span> with constant <span class="math inline">\(0&lt;M&lt;\infty,\)</span> and</li>
<li><span class="math inline">\(f_X(x)\leq m(x)\)</span> for all <span class="math inline">\(x\in\mathbb{R^d}.\)</span></li>
</ul>
<p>Then the Accept-Reject algorithm as introduced in <a href="#sec-ARd1noncompact"><span>Section&nbsp;1.3.3.2</span></a> allows to simulate <span class="math display">\[
X\sim f_X.
\]</span></p>
</div>
</div>
</div>
<p><strong>Proof</strong> of <a href="#thm-ARAlgo2">Theorem&nbsp;<span>1.5</span></a>:</p>
<p>The following derivation shows that the Appcept-Reject algorithm as introduced in <a href="#sec-ARd1noncompact"><span>Section&nbsp;1.3.3.2</span></a> allows to simulate random variables <span class="math inline">\(X\)</span> with the correct target distribution <span class="math inline">\(f_X.\)</span></p>
<p>First, note that <span class="math inline">\(X\sim f_X\)</span> if and only if <span class="math display">\[
P(X\in A) = \int_A f_X(y)dy
\]</span> for every <span class="math inline">\(A\subseteq \mathbb{R}^d.\)</span> I.e., this is what we need to show.</p>
<p>In a first step, we use that <span class="math inline">\(X=Y\)</span> only if <span class="math inline">\(U\leq f_X(Y),\)</span> which implies that<br>
<span class="math display">\[
\begin{align*}
\mathbb{P}(X\in A) &amp; =\mathbb{P}(Y\in A|U\leq f_X(Y)).
\end{align*}
\]</span> The definition of conditional probabilities yields that <span class="math display">\[
\begin{align*}
\mathbb{P}(X\in A)
&amp; = \frac{\mathbb{P}(Y\in A, \; U\leq f_X(Y))}{\mathbb{P}(U\leq f_X(Y))}.
\end{align*}
\]</span> Using that the density function of <span class="math inline">\((Y,U)\sim\mathcal{U}(\mathcal{S})\)</span> equals <span class="math inline">\(\frac{1}{M}\)</span> for all <span class="math inline">\((y,u)\in\mathcal{S}\)</span> and zero else we have that</p>
<ul>
<li><span class="math inline">\(\mathbb{P}(Y\in{\color{red}A}, \; U\leq f_X(Y)) = \int_{\color{red}A}\int_0^{f(y)}\frac{1}{M}\,du\,dy\quad\)</span></li>
</ul>
<p>and that</p>
<ul>
<li><span class="math inline">\(\mathbb{P}(U\leq f_X(Y)) = \int_{\mathbb{R}^d}\int_0^{f(y)}\frac{1}{M}\,du\,dy\quad\)</span> by integrating out <span class="math inline">\(y\)</span> to get the marginal density.</li>
</ul>
<p>Thus, <span class="math display">\[
\begin{align*}
\mathbb{P}(X\in A)
&amp; =\frac{\int_A \int_0^{f_X(y)}\,\frac{1}{M}\,du\,dy}{\int_{\mathbb{R}^d}\int_0^{f(y)}\,\frac{1}{M}\,du\,dy}\\[2ex]
&amp; =\frac{\frac{1}{M}\,\int_A \,\int_0^{f_X(y)}\,1\,du\,dy}{\frac{1}{M}\,\int_{\mathbb{R}^d}\,\int_0^{f(y)}\,1\,du\,dy}\\[2ex]
&amp; =\frac{\int_A \,\int_0^{f_X(y)}\,1\,du\,dy}{\int_{\mathbb{R}^d}\,\int_0^{f(y)}\,1\,du\,dy}\\[2ex]
\end{align*}
\]</span> Using that <span class="math inline">\(\int_{0}^{f_X(y)}\, 1\, du = f_X(y),\)</span> we get that <span class="math display">\[
\begin{align*}
\mathbb{P}(X\in A)
&amp; =\frac{\int_A f_X(y)\,dy}{\int_{\mathbb{R}^d} f_X(y)\,dy}\\[2ex]
&amp; =\int_A f_X(y)dy,
\end{align*}
\]</span> which applies to every set <span class="math inline">\(A\)</span> and thus shows the result.</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that the above derivation implies that we only need to know the density function <span class="math inline">\(f_X\)</span> <strong>up to a multiplicative constant</strong> <span class="math inline">\(c&gt;0,\)</span> since constant factors cancel—just as the normalizing constant <span class="math inline">\(1/M.\)</span></p>
<p>That is, instead of working with <span class="math inline">\(f_X,\)</span> we can also work with a scaled version <span class="math inline">\(\tilde{f}_X\)</span> that is proportional to <span class="math inline">\(f_X,\)</span> <span class="math display">\[
f_{X}(x) = c \tilde{f}_X(x)
\]</span> often written as <span class="math display">\[
f_{X}(x)\propto \tilde{f}_X(x),
\]</span> since the constant <span class="math inline">\(c\)</span> cancels out anyways in the above quotient expression. (The sign “<span class="math inline">\(\propto\)</span>” means “proportional to”.)</p>
<p>This is a very useful property for implementing the Accept-Reject algorithm, since it implies that it is <strong>irrelevant</strong> whether we scale the <strong>instrumental density</strong> <span class="math inline">\(g\)</span> by some <span class="math inline">\(1\leq M &lt;\infty,\)</span> or the <strong>target density</strong> <span class="math inline">\(f_X\)</span> by some constant <span class="math inline">\(c&gt;0.\)</span> All we need is that <span class="math display">\[
\frac{1}{c}f_X(x)=\tilde{f}_X(x) \leq M g(x) \text{ for all } x\in\mathbb{R}^d.
\]</span> for some some <span class="math inline">\(c&gt;0\)</span> and some <span class="math inline">\(1\leq M &lt; \infty.\)</span> This allows us to choose <span class="math inline">\(c\)</span> and <span class="math inline">\(M\)</span> such that simulating from <span class="math inline">\(M g\)</span> is as simple as possible.</p>
</div>
</div>
<!-- All this leads to a more general version of the Fundamental Theorem of Simulation: -->
<!-- ::: {.callout-note icon=false} 

## 
::: {#thm-ARAlgo2}

## Fundamental Theorem of Simulation (General Version)

Let $X\sim f_X$ and let $g$ be a density function such that 
$$
f_X(x)\leq M\,g(x)
$$ 
for some $M$ with $1\leq M<\infty$ and all $x\in\mathbb{R}^d.$ 

Then simulating $X\sim f_X$ is equivalent to simulating 
$$
Y\sim g\quad\text{and}\quad U|Y=y\sim\mathcal{U}[0,M\,g(y)]
$$
of one **accepts** $Y$ as a simulation for $X$ (i.e. sets $X=Y$) only if 
$U\leq f_X(Y),$ and **rejects** all other $Y$'s.
:::
::: -->
<!-- The Accept-Reject Algorithm (General Version):

```
# Accept-Reject Algorithm:
Y   <- generate n random numbers from g(.)

# Specify function m():
m <- function(y){YOUR CODE}

U   <- numeric(n)
for(i in 1:n){
  U[i] <- runif(n=1, min = 0, max = m(Y[i])) 
}

# A-R Step:
accept <- U <= f(Y)
X      <- Y[accept]
``` -->
<div id="exm-ARAlgo2Example" class="theorem example">
<p><span class="theorem-title"><strong>Example 1.8 </strong></span>Let the target “density” be <span class="math display">\[
f_X(x)\propto \exp(-x^2/2)\,(\sin(6x)^2 + 3\cos(x)^2\,\sin(4x)^2 + 1).
\]</span></p>
<p>Given our considerations above, we can try to scaling such that the above “density” is dominated (i.e.&nbsp;<span class="math inline">\(\tilde{f}_X(x) \leq g(x)\)</span> for all <span class="math inline">\(x\)</span>) by the standard normal density <span class="math display">\[
g(x)=\frac{1}{\sqrt{2\pi}}\exp(-x^2/2),
\]</span> which is obviously straightforward to simulate from.</p>
<p>Thus, in this example we can set <span class="math display">\[
m(x)=M\,g(x)\quad\text{with}\quad M=1,
\]</span> since we can simply scale the target “density” <span class="math inline">\(f_X\)</span> such that <span class="math display">\[
\tilde{f}_X(x)\leq g(x)\quad\text{for all}\quad x.
\]</span> Specifically, we can set <span class="math display">\[
\tilde{f}_X(x)=0.075 \cdot \exp(-x^2/2)\,(\sin(6x)^2 + 3\cos(x)^2\,\sin(4x)^2 + 1).
\]</span></p>
<p>The following code provides a possible implementation of the Accept-Reject algorithm for this example. <a href="#fig-ARAlgo2Example">Figure&nbsp;<span>1.4</span></a> shows the results.</p>
<div class="cell" data-hash="Ch1_Random_Variable_Generation_cache/html/unnamed-chunk-16_34c2dd8327c9a853f9f705e747c20a47">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Target density</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>target_pdf <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">c=</span>.<span class="dv">075</span>){</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  pdf <span class="ot">&lt;-</span> c <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> </span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>            (<span class="fu">sin</span>(<span class="dv">6</span><span class="sc">*</span>x)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">3</span><span class="sc">*</span><span class="fu">cos</span>(x)<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">sin</span>(<span class="dv">4</span><span class="sc">*</span>x)<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(pdf)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Upper bound</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>m_fun <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(m)  </span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Accept-Reject Algo:</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">32280</span>)</span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 1. Generate Y</span></span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>Y   <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n=</span><span class="dv">1000</span>)</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 2. Generate U|Y=y </span></span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>U   <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> <span class="fu">length</span>(Y), <span class="at">mode =</span> <span class="st">"double"</span>)</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(Y)){</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>  U[i] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n=</span><span class="dv">1</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="fu">m_fun</span>(Y[i])) </span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="co"># A-R Step:</span></span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>accept <span class="ot">&lt;-</span> U <span class="sc">&lt;=</span> <span class="fu">target_pdf</span>(Y)</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a>X      <span class="ot">&lt;-</span> Y[accept]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="Ch1_Random_Variable_Generation_cache/html/fig-ARAlgo2Example_d9bed0f3f3aa4bc0eccafe52bbf208be">
<div class="cell-output-display">
<div id="fig-ARAlgo2Example" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="Ch1_Random_Variable_Generation_files/figure-html/fig-ARAlgo2Example-1.png" class="img-fluid figure-img" width="672"></p>
<p></p><figcaption class="figure-caption">Figure&nbsp;1.4: Accept-Reject algorithm for univariate <span class="math inline">\((d=1)\)</span> densities with non-compact support—visualizing <a href="#exm-ARAlgo2Example">Example&nbsp;<span>1.8</span></a>.</figcaption><p></p>
</figure>
</div>
</div>
</div>
<div class="cell" data-hash="Ch1_Random_Variable_Generation_cache/html/unnamed-chunk-18_3825b6cf40949a306fe5721ef1ca45a6">

</div>
</div>
</section>
<section id="efficiency-of-the-accept-reject-algorithm" class="level4" data-number="1.3.3.3">
<h4 data-number="1.3.3.3" class="anchored" data-anchor-id="efficiency-of-the-accept-reject-algorithm"><span class="header-section-number">1.3.3.3</span> Efficiency of the Accept-Reject algorithm</h4>
<p>Simple statements with respect to the efficiency of the Accept-Reject algorithm can be made if <span class="math inline">\(f_X\)</span> and <span class="math inline">\(g\)</span> are both <strong>normalized</strong> such that they are <strong>both density functions</strong>. Then:</p>
<ul>
<li>The constant <span class="math inline">\(M\)</span> is necessarily larger than <span class="math inline">\(1\)</span>.</li>
<li>The probability of acceptance is <span class="math inline">\(1/M\)</span>. (See Exercises.)</li>
<li><span class="math inline">\(M\)</span> is interpreted as the <strong>efficiency</strong> of the Accept-Reject algorithm. The closer <span class="math inline">\(M\)</span> is to <span class="math inline">\(1\)</span> the better.</li>
<li><span class="math inline">\(M\)</span> quantifies how closely <span class="math inline">\(g\)</span> can imitate <span class="math inline">\(f_X.\)</span></li>
</ul>
<div id="exm-AREfficiency" class="theorem example">
<p><span class="theorem-title"><strong>Example 1.9 (Normals from Double Exponentials) </strong></span>Consider simulating from <span class="math inline">\(\mathcal{N}(0,1)\)</span> using the Accept-Reject algorithm with the a double-exponential distribution <span class="math inline">\(\mathcal{L}(\alpha),\)</span> also called <a href="https://en.wikipedia.org/wiki/Laplace_distribution">Laplace distribution</a>, as the instrumental density, <span class="math display">\[
g(x|b)=\frac{1}{2b}\exp\left(-\frac{|x|}{b}\right).
\]</span> <!-- here: location-param mu=0, scale.param=b\geq 0, precision=alpha=b^{-1} --> It is then straightforward to show (see Exercises) that <span class="math display">\[
\begin{align*}
\frac{f(x)}{g(x|b)}
%&amp;=\frac{\frac{1}{\sqrt{2\pi}}\exp\left(-\frac{1}{2}x^2\right)}{\frac{1}{2b}\exp\left(-\frac{|x|}{b}\right)}\\[2ex]
%&amp;=\sqrt{\frac{2}{\pi}}\,b\,\exp\left(-\frac{1}{2}x^2+\frac{|x|}{b}\right)\\[2ex]
&amp;\leq\sqrt{\frac{2}{\pi}}\,b\,\exp\left(\frac{1}{2\,b^2}\right)
\end{align*}
\]</span> and that the minimum of the bound (in <span class="math inline">\(b\)</span>) is attained for <span class="math inline">\(b=1\)</span>.</p>
<p>This leads to the following optimal (i.e.&nbsp;most efficient) specification of the double-exponential distribution as instrumental density: <span class="math display">\[
\begin{align*}
\frac{f(x)}{g(x|1)} \leq M
&amp; =\sqrt{\frac{2}{\pi}}\,\exp\left(\frac{1}{2}\right)\\[2ex]
&amp; =\sqrt{\frac{2}{\pi} \,\exp\left(1\right)}.
\end{align*}
\]</span></p>
<p>The probability of acceptance is then <span class="math display">\[
\frac{1}{M}=\sqrt{\frac{\pi}{2\exp(1)}}\approx 0.76.
\]</span> I.e., to produce one normal random variable, this Accept-Reject algorithm requires on average <span class="math display">\[
\frac{1}{0.76}\approx 1.3
\]</span> uniform variables.</p>
<p>This is to be compared with the Box-Muller algorithm for which the ratio between produced normals and required uniforms is <span class="math inline">\(1.\)</span></p>
</div>
</section>
<section id="the-instrumental-density-g-needs-thicker-tails-than-the-target-density-f_x" class="level4" data-number="1.3.3.4">
<h4 data-number="1.3.3.4" class="anchored" data-anchor-id="the-instrumental-density-g-needs-thicker-tails-than-the-target-density-f_x"><span class="header-section-number">1.3.3.4</span> The instrumental density <span class="math inline">\(g\)</span> needs thicker tails than the target density <span class="math inline">\(f_X\)</span></h4>
<p>Note that, for normalized <span class="math inline">\(f_X\)</span> and <span class="math inline">\(g\)</span> the inequality <span class="math display">\[
f_X(x)\leq M\,g(x),
\]</span> with <span class="math inline">\(1&lt;M&lt;\infty\)</span> for all <span class="math inline">\(x\in\mathbb{R}^d,\)</span> implies that the quotient <span class="math inline">\(f_X/g\)</span> is bounded, i.e., that <span class="math display">\[
0\leq \frac{f_X(x)}{g(x)}\leq M &lt;\infty\quad\text{for all}\quad x.
\]</span></p>
<p>This implies, for instance, that <span class="math inline">\(g\)</span> <strong>has to have thicker tails</strong> than <span class="math inline">\(f_X.\)</span></p>
<p>To see this, observe that both <span class="math display">\[
f_X(|x|)\to 0 \quad\text{and}\quad g(|x|)\to 0
\]</span> for “extreme” values <span class="math inline">\(|x|\to\infty,\)</span> simply because both <span class="math inline">\(f_X\)</span> and <span class="math inline">\(g\)</span> are densities.</p>
<p>If <span class="math inline">\(g\)</span> has <strong>thicker tails</strong> than <span class="math inline">\(f_X,\)</span> then <span class="math display">\[
0 \leq \frac{f_X(|x|)}{g(|x|)} \leq 1 \leq M
\]</span> for all sufficiently large values <span class="math inline">\(|x|.\)</span> Thus with <span class="math inline">\(g\)</span> having thicker tails than <span class="math inline">\(f_X,\)</span> we can be sure that the requirement <span class="math inline">\(\frac{f_X(x)}{g(x)}\leq M &lt;\infty\)</span> holds for all sufficiently extreme values of <span class="math inline">\(x.\)</span></p>
<p>By constrast, if <span class="math inline">\(g\)</span> has strictly <strong>thinner tails</strong> than <span class="math inline">\(f_X,\)</span> then <span class="math display">\[
0\leq \frac{f_X(|x|)}{g(|x|)} \to\infty,\quad\text{as}\quad|x|\to\infty,
\]</span> which makes the requirement that <span class="math inline">\(\frac{f_X(x)}{g(x)}\leq M &lt;\infty\)</span> impossible to hold for extreme values of <span class="math inline">\(x.\)</span></p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Therefore, it is, for instance, impossible to simulate from a Cauchy density <span class="math inline">\(f_X\)</span> using a normal density <span class="math inline">\(g\)</span>. The reverse, however, works quite well.</p>
</div>
</div>
<!-- ::: {.callout-tip}
Remember: Using the Cauchy as instrumental density $g$ does not harm the integrability/feasibility requirement! The fact that the Cauchy distribution has no mean, does not change the fact that the density of the Cauchy integrates to one.
::: -->
</section>
</section>
</section>
<section id="references" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="references">References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" role="doc-bibliography">
<div id="ref-BoxMuller1958" class="csl-entry" role="doc-biblioentry">
Box, George EP, and Mervin E Muller. 1958. <span>“A Note on the Generation of Random Normal Deviates.”</span> <em>The Annals of Mathematical Statistics</em> 29 (2): 610–11. <a href="https://projecteuclid.org/euclid.aoms/1177706645">https://projecteuclid.org/euclid.aoms/1177706645</a>.
</div>
<div id="ref-RobertCasella1999" class="csl-entry" role="doc-biblioentry">
Robert, Christian P, and George Casella. 2004. <em>Monte Carlo Statistical Methods</em>. 2nd ed. Springer Texts in Statistics. Springer.
</div>
<div id="ref-RobertCasella2010" class="csl-entry" role="doc-biblioentry">
———. 2010. <em>Introducing Monte Carlo Methods with r</em>. 1st ed. Use r! Springer.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./index.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Organization of the Course</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./Ch2_MonteCarlo.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Monte Carlo Integration</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>